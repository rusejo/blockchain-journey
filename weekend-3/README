Full final code with GUI integrated.
